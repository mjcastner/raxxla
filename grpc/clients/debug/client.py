import api_raxxla_pb2
import api_raxxla_pb2_grpc
import grpc
import json

from absl import app, flags, logging

FLAGS = flags.FLAGS
flags.DEFINE_string('server_host', '172.17.0.2',
                    'Host for Raxxla debug gRPC server.')
flags.DEFINE_string('server_port', '50051',
                    'Port for Raxxla debug gRPC server.')
flags.DEFINE_enum('channel_type', 'insecure', ['insecure', 'secure'],
                  'gRPC channel type to use.')

# Example JSON data
POWERPLAY_JSON = '''{"power":"Edmund Mahon","powerState":"Exploited","id":15453,"id64":6406111564522,"name":"Kitchosat","coords":{"x":21.90625,"y":64.8125,"z":107.625},"allegiance":"Independent","government":"Corporate","state":"None","date":"2020-12-24 04:17:51"}'''
POPULATION_JSON = '''{"id":2713216,"id64":1732851569378,"name":"Col 285 Sector HD-I c10-6","coords":{"x":-163.0625,"y":19.90625,"z":72.21875},"allegiance":"Independent","government":"Confederacy","state":"Expansion","economy":"Colony","security":"Medium","population":625337,"controllingFaction":{"id":82049,"name":"Formidine Greybeard Guild","allegiance":"Independent","government":"Confederacy","isPlayer":false},"factions":[{"id":82049,"name":"Formidine Greybeard Guild","allegiance":"Independent","government":"Confederacy","influence":0.666,"state":"Expansion","activeStates":[{"state":"Expansion"}],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":8462,"name":"Chnouphis Alliance","allegiance":"Independent","government":"Confederacy","influence":0.107,"state":"Expansion","activeStates":[{"state":"Expansion"}],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":18032,"name":"Revolutionary HIP 96906 Green Party","allegiance":"Federation","government":"Democracy","influence":0.084,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":23244,"name":"Araki Independent Consulate","allegiance":"Independent","government":"Patronage","influence":0.072,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":81342,"name":"STAR Confederation","allegiance":"Independent","government":"Confederacy","influence":0.071,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[{"state":"Expansion","trend":0}],"happiness":"Happy","isPlayer":true,"lastUpdate":1611516573},{"id":24619,"name":"Confederation of HIP 97174","allegiance":"Independent","government":"Confederacy","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":4600,"name":"Cakutsi Movement","allegiance":"Independent","government":"Dictatorship","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":75935,"name":"Kamebis Commodities","allegiance":"Independent","government":"Corporate","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":81923,"name":"Pilots' Federation Local Branch","allegiance":"Pilots Federation","government":"Democracy","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"None","isPlayer":false,"lastUpdate":1611516573},{"id":20872,"name":"Party of Kholita","allegiance":"Independent","government":"Dictatorship","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"None","isPlayer":false,"lastUpdate":1611516573},{"id":24285,"name":"Workers of Kamebis League","allegiance":"Independent","government":"Confederacy","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":11879,"name":"Corian Guit Corp.","allegiance":"Federation","government":"Corporate","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"Happy","isPlayer":false,"lastUpdate":1611516573},{"id":47982,"name":"Kholita Jet Council","allegiance":"Independent","government":"Anarchy","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"None","isPlayer":false,"lastUpdate":1611516573},{"id":47983,"name":"Kholita Focus","allegiance":"Independent","government":"Dictatorship","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"None","isPlayer":false,"lastUpdate":1611516573},{"id":47984,"name":"Labour of Kholita","allegiance":"Independent","government":"Democracy","influence":0,"state":"None","activeStates":[],"recoveringStates":[],"pendingStates":[],"happiness":"None","isPlayer":false,"lastUpdate":1611516573}],"stations":[{"id":53086,"marketId":3527331840,"type":"Planetary Outpost","name":"Hertz Depot","body":{"id":2651888,"name":"Col 285 Sector HD-I c10-6 2 c","latitude":8.65862,"longitude":-175.324},"distanceToArrival":1497,"allegiance":"Independent","government":"Confederacy","economy":"Military","secondEconomy":null,"haveMarket":true,"haveShipyard":false,"haveOutfitting":true,"otherServices":["Black Market","Restock","Refuel","Repair","Contacts","Universal Cartographics","Missions","Crew Lounge","Tuning","Search and Rescue"],"controllingFaction":{"id":82049,"name":"Formidine Greybeard Guild"},"updateTime":{"information":"2021-01-24 16:59:17","market":"2020-09-06 15:09:03","shipyard":null,"outfitting":"2020-09-06 15:09:07"}},{"id":53088,"marketId":3527331584,"type":"Planetary Port","name":"Maudslay Lab","body":{"id":3237031,"name":"Col 285 Sector HD-I c10-6 3 f","latitude":25.124,"longitude":3.80774},"distanceToArrival":2101,"allegiance":"Independent","government":"Confederacy","economy":"Colony","secondEconomy":null,"haveMarket":true,"haveShipyard":true,"haveOutfitting":true,"otherServices":["Black Market","Restock","Refuel","Repair","Contacts","Universal Cartographics","Missions","Crew Lounge","Tuning","Search and Rescue"],"controllingFaction":{"id":8462,"name":"Chnouphis Alliance"},"updateTime":{"information":"2021-01-10 15:29:36","market":"2020-12-31 01:00:06","shipyard":"2020-02-28 17:18:35","outfitting":"2020-12-31 01:00:06"}}],"bodies":[{"id":2651847,"id64":1732851569378,"bodyId":0,"name":"Col 285 Sector HD-I c10-6","type":"Star","subType":"K (Yellow-Orange) Star","parents":null,"distanceToArrival":0,"isMainStar":true,"isScoopable":true,"age":8868,"spectralClass":"K3","luminosity":"Va","absoluteMagnitude":5.894104,"solarMasses":0.75,"solarRadius":0.9081115053918044,"surfaceTemperature":4746,"orbitalPeriod":null,"semiMajorAxis":null,"orbitalEccentricity":null,"orbitalInclination":null,"argOfPeriapsis":null,"rotationalPeriod":3.4954681328819444,"rotationalPeriodTidallyLocked":false,"axialTilt":null,"belts":[{"name":"Col 285 Sector HD-I c10-6 A Belt","type":"Rocky","mass":124990000000000,"innerRadius":1042100,"outerRadius":2331700},{"name":"Col 285 Sector HD-I c10-6 B Belt","type":"Metal Rich","mass":36860000000000000,"innerRadius":11261000,"outerRadius":282620000}],"updateTime":"2020-06-12 01:31:44"},{"id":3237024,"id64":360289703041209058,"bodyId":10,"name":"Col 285 Sector HD-I c10-6 1","type":"Planet","subType":"High metal content world","parents":[{"Star":0}],"distanceToArrival":22,"isLandable":true,"gravity":1.027978077078947,"earthMasses":0.815443,"radius":5680.537,"surfaceTemperature":949,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":64.57,"Metal":35.43,"Ice":0},"terraformingState":"Not terraformable","orbitalPeriod":3.7889733082754633,"semiMajorAxis":0.043421533966360795,"orbitalEccentricity":2.7e-5,"orbitalInclination":-5.6e-5,"argOfPeriapsis":304.518715,"rotationalPeriod":-3.693685671412037,"rotationalPeriodTidallyLocked":false,"axialTilt":-1.606951,"materials":{"Iron":23.29,"Nickel":17.61,"Sulphur":16,"Carbon":13.45,"Phosphorus":8.61,"Zinc":6.33,"Vanadium":5.72,"Germanium":4.77,"Cadmium":1.81,"Niobium":1.59,"Technetium":0.83},"updateTime":"2020-12-29 13:11:52"},{"id":2651883,"id64":756606470249812706,"bodyId":21,"name":"Col 285 Sector HD-I c10-6 2","type":"Planet","subType":"Class III gas giant","parents":[{"Star":0}],"distanceToArrival":1496,"isLandable":false,"gravity":14.504746605527558,"earthMasses":1947.05188,"radius":73895.536,"surfaceTemperature":499,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":{"Hydrogen":74.13,"Helium":25.87},"solidComposition":null,"terraformingState":"Not terraformable","orbitalPeriod":2174.1867617324074,"semiMajorAxis":2.9983937715614157,"orbitalEccentricity":0.000169,"orbitalInclination":-0.363726,"argOfPeriapsis":331.321818,"rotationalPeriod":1.131069922488426,"rotationalPeriodTidallyLocked":false,"axialTilt":2.188784,"updateTime":"2020-09-27 16:25:45"},{"id":9508578,"id64":792635267268776674,"bodyId":22,"name":"Col 285 Sector HD-I c10-6 2 a","type":"Planet","subType":"Rocky body","parents":[{"Planet":21},{"Star":0}],"distanceToArrival":1495,"isLandable":true,"gravity":0.08959261376045902,"earthMasses":0.001291,"radius":765.6169375,"surfaceTemperature":198,"surfacePressure":null,"volcanismType":"Minor Metallic Magma","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":90.95,"Metal":9.05,"Ice":0},"terraformingState":null,"orbitalPeriod":1.2522528844907408,"semiMajorAxis":0.0040963033284803965,"orbitalEccentricity":0.001412,"orbitalInclination":0.002869,"argOfPeriapsis":356.633055,"rotationalPeriod":1.252259475798611,"rotationalPeriodTidallyLocked":false,"axialTilt":-0.440312,"materials":{"Iron":19.76,"Sulphur":19.14,"Carbon":16.1,"Nickel":14.95,"Phosphorus":10.31,"Manganese":8.16,"Germanium":5.7,"Arsenic":2.55,"Molybdenum":1.29,"Yttrium":1.18,"Mercury":0.86},"updateTime":"2020-09-27 16:25:54"},{"id":9508602,"id64":828664064287740642,"bodyId":23,"name":"Col 285 Sector HD-I c10-6 2 b","type":"Planet","subType":"Rocky body","parents":[{"Planet":21},{"Star":0}],"distanceToArrival":1495,"isLandable":false,"gravity":0.07417149850537005,"earthMasses":0.000737,"radius":635.7695625,"surfaceTemperature":190,"surfacePressure":null,"volcanismType":"Major Rocky Magma","atmosphereType":"Sulphur dioxide","atmosphereComposition":{"Sulphur dioxide":90,"Silicates":5,"Oxygen":3},"solidComposition":{"Rock":90.95,"Metal":9.05,"Ice":0},"terraformingState":null,"orbitalPeriod":1.7147831342824076,"semiMajorAxis":0.005051304492170222,"orbitalEccentricity":3.6e-5,"orbitalInclination":-0.011437,"argOfPeriapsis":114.714035,"rotationalPeriod":1.7147923064930557,"rotationalPeriodTidallyLocked":false,"axialTilt":-0.317125,"updateTime":"2020-09-27 16:25:56"},{"id":2651888,"id64":864692861306704610,"bodyId":24,"name":"Col 285 Sector HD-I c10-6 2 c","type":"Planet","subType":"Rocky body","parents":[{"Planet":21},{"Star":0}],"distanceToArrival":1497,"isLandable":true,"gravity":0.10954552321862196,"earthMasses":0.002323,"radius":928.77775,"surfaceTemperature":178,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":90.58,"Metal":9.42,"Ice":0},"terraformingState":"Not terraformable","orbitalPeriod":2.8030961337962963,"semiMajorAxis":0.0070095390586819364,"orbitalEccentricity":0.000164,"orbitalInclination":0.188597,"argOfPeriapsis":237.475784,"rotationalPeriod":-2.803111010925926,"rotationalPeriodTidallyLocked":false,"axialTilt":-2.465277,"materials":{"Iron":19.82,"Sulphur":19.05,"Carbon":16.02,"Nickel":14.99,"Phosphorus":10.26,"Chromium":8.91,"Vanadium":4.87,"Arsenic":2.54,"Cadmium":1.54,"Molybdenum":1.29,"Technetium":0.71},"updateTime":"2020-09-27 16:25:50"},{"id":9508536,"id64":900721658325668578,"bodyId":25,"name":"Col 285 Sector HD-I c10-6 2 d","type":"Planet","subType":"Rocky body","parents":[{"Planet":21},{"Star":0}],"distanceToArrival":1492,"isLandable":true,"gravity":0.10009902806241035,"earthMasses":0.001791,"radius":853.13425,"surfaceTemperature":161,"surfacePressure":0.0006141761658031088,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":90.95,"Metal":9.05,"Ice":0},"terraformingState":null,"orbitalPeriod":7.233403209178241,"semiMajorAxis":0.013187400599487946,"orbitalEccentricity":0.000152,"orbitalInclination":0.04762,"argOfPeriapsis":285.591075,"rotationalPeriod":7.233442106041666,"rotationalPeriodTidallyLocked":false,"axialTilt":0.359288,"materials":{"Iron":18.55,"Sulphur":17.97,"Carbon":15.11,"Nickel":14.03,"Phosphorus":9.67,"Chromium":8.34,"Manganese":7.66,"Zinc":5.04,"Niobium":1.27,"Molybdenum":1.21,"Ruthenium":1.15},"updateTime":"2020-09-27 16:26:11"},{"id":9508683,"id64":972779252363596514,"bodyId":27,"name":"Col 285 Sector HD-I c10-6 2 e","type":"Planet","subType":"Rocky body","parents":[{"Null":26},{"Planet":21},{"Star":0}],"distanceToArrival":1487,"isLandable":true,"gravity":0.09906993766906556,"earthMasses":0.001736,"radius":844.28375,"surfaceTemperature":152,"surfacePressure":null,"volcanismType":"Minor Silicate Vapour Geysers","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":90.95,"Metal":9.05,"Ice":0},"terraformingState":null,"orbitalPeriod":0.9575619948726851,"semiMajorAxis":1.7106370932002845e-5,"orbitalEccentricity":0.131081,"orbitalInclination":-9.494333,"argOfPeriapsis":213.244684,"rotationalPeriod":1.4599253213773147,"rotationalPeriodTidallyLocked":false,"axialTilt":0.00872,"materials":{"Iron":19.55,"Sulphur":18.93,"Carbon":15.92,"Nickel":14.78,"Phosphorus":10.19,"Chromium":8.79,"Germanium":5.64,"Selenium":2.96,"Ruthenium":1.21,"Tin":1.17,"Mercury":0.85},"updateTime":"2020-09-27 16:26:03"},{"id":9508667,"id64":1008808049382560482,"bodyId":28,"name":"Col 285 Sector HD-I c10-6 2 f","type":"Planet","subType":"Rocky body","parents":[{"Null":26},{"Planet":21},{"Star":0}],"distanceToArrival":1487,"isLandable":true,"gravity":0.09003118651542666,"earthMasses":0.00131,"radius":769.3495,"surfaceTemperature":152,"surfacePressure":null,"volcanismType":"Minor Metallic Magma","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":90.95,"Metal":9.05,"Ice":0},"terraformingState":null,"orbitalPeriod":0.9575619948726851,"semiMajorAxis":2.2657199817383495e-5,"orbitalEccentricity":0.131081,"orbitalInclination":-9.494333,"argOfPeriapsis":33.244689,"rotationalPeriod":2.537093189236111,"rotationalPeriodTidallyLocked":false,"axialTilt":0.344308,"materials":{"Iron":19.52,"Sulphur":18.91,"Carbon":15.9,"Nickel":14.77,"Phosphorus":10.18,"Chromium":8.78,"Germanium":5.64,"Selenium":2.96,"Molybdenum":1.27,"Ruthenium":1.21,"Mercury":0.85},"updateTime":"2020-09-27 16:25:59"},{"id":9508649,"id64":1044836846401524450,"bodyId":29,"name":"Col 285 Sector HD-I c10-6 2 g","type":"Planet","subType":"Rocky body","parents":[{"Planet":21},{"Star":0}],"distanceToArrival":1509,"isLandable":false,"gravity":0.11275926299772643,"earthMasses":0.002544,"radius":958.0031875,"surfaceTemperature":172,"surfacePressure":0.023627410441648164,"volcanismType":"No volcanism","atmosphereType":"Thin Carbon dioxide","atmosphereComposition":{"Carbon dioxide":99.01,"Sulphur dioxide":0.99},"solidComposition":{"Rock":90.95,"Metal":9.05,"Ice":0},"terraformingState":null,"orbitalPeriod":27.7388371803125,"semiMajorAxis":0.03230895874828183,"orbitalEccentricity":0.000336,"orbitalInclination":0.079707,"argOfPeriapsis":208.576502,"rotationalPeriod":27.738985817881943,"rotationalPeriodTidallyLocked":false,"axialTilt":0.426343,"updateTime":"2020-09-27 16:26:15"},{"id":3237027,"id64":1116894440439452386,"bodyId":31,"name":"Col 285 Sector HD-I c10-6 3","type":"Planet","subType":"Class III gas giant","parents":[{"Star":0}],"distanceToArrival":2125,"isLandable":false,"gravity":9.1527598050726,"earthMasses":1323.21228,"radius":76687.264,"surfaceTemperature":332,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":{"Hydrogen":74.13,"Helium":25.87},"solidComposition":null,"terraformingState":"Not terraformable","orbitalPeriod":3669.566233400926,"semiMajorAxis":4.250440623661564,"orbitalEccentricity":0.002004,"orbitalInclination":-0.045993,"argOfPeriapsis":184.078714,"rotationalPeriod":1.287216026574074,"rotationalPeriodTidallyLocked":false,"axialTilt":-0.320939,"rings":[{"name":"Col 285 Sector HD-I c10-6 3 A Ring","type":"Metal Rich","mass":3847500000000,"innerRadius":117860,"outerRadius":382200}],"reserveLevel":"Pristine","updateTime":"2020-09-27 16:24:23"},{"id":10151672,"id64":1188952034477380322,"bodyId":33,"name":"Col 285 Sector HD-I c10-6 3 a","type":"Planet","subType":"Rocky body","parents":[{"Planet":31},{"Star":0}],"distanceToArrival":2123,"isLandable":false,"gravity":0.08615545126789399,"earthMasses":0.00115,"radius":736.872,"surfaceTemperature":247,"surfacePressure":1.3802038613372811,"volcanismType":"No volcanism","atmosphereType":"Carbon dioxide","atmosphereComposition":{"Carbon dioxide":98.97,"Sulphur dioxide":0.99},"solidComposition":{"Rock":90.96,"Metal":9.04,"Ice":0},"terraformingState":null,"orbitalPeriod":2.249332903715278,"semiMajorAxis":0.005321773581318895,"orbitalEccentricity":0.00017,"orbitalInclination":0.004797,"argOfPeriapsis":246.414599,"rotationalPeriod":2.2493903084722224,"rotationalPeriodTidallyLocked":true,"axialTilt":-0.33133,"updateTime":"2020-09-27 16:24:40"},{"id":10151677,"id64":1224980831496344290,"bodyId":34,"name":"Col 285 Sector HD-I c10-6 3 b","type":"Planet","subType":"Rocky body","parents":[{"Planet":31},{"Star":0}],"distanceToArrival":2122,"isLandable":true,"gravity":0.07587256505836745,"earthMasses":0.00079,"radius":650.8121875,"surfaceTemperature":130,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":90.96,"Metal":9.04,"Ice":0},"terraformingState":null,"orbitalPeriod":5.081256989525463,"semiMajorAxis":0.009162233279474746,"orbitalEccentricity":3.5e-5,"orbitalInclination":0.069659,"argOfPeriapsis":51.646824,"rotationalPeriod":5.08138631,"rotationalPeriodTidallyLocked":true,"axialTilt":0.181188,"materials":{"Iron":19.12,"Sulphur":18.53,"Carbon":15.58,"Nickel":14.46,"Phosphorus":9.97,"Manganese":7.9,"Germanium":5.52,"Zinc":5.2,"Cadmium":1.49,"Ruthenium":1.18,"Tungsten":1.05},"updateTime":"2020-09-27 16:24:44"},{"id":10151669,"id64":1297038425534272226,"bodyId":36,"name":"Col 285 Sector HD-I c10-6 3 c","type":"Planet","subType":"Rocky body","parents":[{"Null":35},{"Planet":31},{"Star":0}],"distanceToArrival":2119,"isLandable":true,"gravity":0.10713234981838725,"earthMasses":0.002188,"radius":911.4815,"surfaceTemperature":118,"surfacePressure":null,"volcanismType":"Minor Silicate Vapour Geysers","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":90.96,"Metal":9.04,"Ice":0},"terraformingState":null,"orbitalPeriod":0.8903121506712963,"semiMajorAxis":1.6966149407780306e-5,"orbitalEccentricity":0.002947,"orbitalInclination":-2.721038,"argOfPeriapsis":96.36063,"rotationalPeriod":1.3776671081481482,"rotationalPeriodTidallyLocked":true,"axialTilt":-0.322418,"materials":{"Iron":19.2,"Sulphur":18.6,"Carbon":15.64,"Nickel":14.53,"Phosphorus":10.02,"Chromium":8.64,"Zinc":5.22,"Vanadium":4.72,"Cadmium":1.49,"Molybdenum":1.25,"Technetium":0.69},"updateTime":"2020-09-27 16:24:36"},{"id":10151675,"id64":1333067222553236194,"bodyId":37,"name":"Col 285 Sector HD-I c10-6 3 d","type":"Planet","subType":"Rocky body","parents":[{"Null":35},{"Planet":31},{"Star":0}],"distanceToArrival":2119,"isLandable":true,"gravity":0.09570767451446456,"earthMasses":0.001569,"radius":816.624875,"surfaceTemperature":118,"surfacePressure":null,"volcanismType":"Minor Metallic Magma","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Rock":90.96,"Metal":9.04,"Ice":0},"terraformingState":null,"orbitalPeriod":0.8903121506712963,"semiMajorAxis":2.3658285231074483e-5,"orbitalEccentricity":0.002947,"orbitalInclination":-2.721038,"argOfPeriapsis":276.360625,"rotationalPeriod":1.1666598970949074,"rotationalPeriodTidallyLocked":true,"axialTilt":-0.48502,"materials":{"Iron":19.04,"Sulphur":18.44,"Carbon":15.51,"Nickel":14.4,"Phosphorus":9.93,"Chromium":8.56,"Germanium":5.5,"Vanadium":4.68,"Cadmium":1.48,"Niobium":1.3,"Antimony":1.16},"updateTime":"2020-09-27 16:24:33"},{"id":9510840,"id64":1369096019572200162,"bodyId":38,"name":"Col 285 Sector HD-I c10-6 3 e","type":"Planet","subType":"Icy body","parents":[{"Planet":31},{"Star":0}],"distanceToArrival":2120,"isLandable":true,"gravity":0.13242760781351007,"earthMasses":0.015148,"radius":2157.113,"surfaceTemperature":99,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Ice":81.66,"Rock":16.67,"Metal":1.66},"terraformingState":null,"orbitalPeriod":41.67003005190973,"semiMajorAxis":0.03725945114707906,"orbitalEccentricity":0.000882,"orbitalInclination":-0.079047,"argOfPeriapsis":321.405251,"rotationalPeriod":-41.67108947273148,"rotationalPeriodTidallyLocked":false,"axialTilt":-1.791624,"materials":{"Sulphur":26.61,"Carbon":22.38,"Phosphorus":14.33,"Iron":12.23,"Nickel":9.25,"Chromium":5.5,"Selenium":4.17,"Germanium":3.53,"Yttrium":0.73,"Tin":0.73,"Mercury":0.53},"updateTime":"2020-09-27 16:24:49"},{"id":3237031,"id64":1405124816591164130,"bodyId":39,"name":"Col 285 Sector HD-I c10-6 3 f","type":"Planet","subType":"Icy body","parents":[{"Planet":31},{"Star":0}],"distanceToArrival":2101,"isLandable":true,"gravity":0.1391604336204469,"earthMasses":0.017458,"radius":2259.03975,"surfaceTemperature":97,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Ice":81.57,"Rock":16.75,"Metal":1.67},"terraformingState":"Not terraformable","orbitalPeriod":67.7948810712037,"semiMajorAxis":0.05154088228477105,"orbitalEccentricity":0.016115,"orbitalInclination":-1.838276,"argOfPeriapsis":238.00956,"rotationalPeriod":67.79661492797453,"rotationalPeriodTidallyLocked":true,"axialTilt":-0.514972,"materials":{"Sulphur":26.71,"Carbon":22.46,"Phosphorus":14.38,"Iron":12.3,"Nickel":9.3,"Chromium":5.53,"Selenium":4.18,"Vanadium":3.02,"Cadmium":0.96,"Niobium":0.84,"Polonium":0.32},"updateTime":"2020-09-27 16:24:59"},{"id":3237032,"id64":1441153613610128098,"bodyId":40,"name":"Col 285 Sector HD-I c10-6 3 f a","type":"Planet","subType":"Icy body","parents":[{"Planet":39},{"Planet":31},{"Star":0}],"distanceToArrival":2101,"isLandable":true,"gravity":0.03431174022860462,"earthMasses":0.000332,"radius":627.3821875,"surfaceTemperature":97,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Ice":92.55,"Rock":7.21,"Metal":0.24},"terraformingState":"Not terraformable","orbitalPeriod":4.065923392777778,"semiMajorAxis":0.00018777261122077587,"orbitalEccentricity":null,"orbitalInclination":46.844405,"argOfPeriapsis":253.464478,"rotationalPeriod":4.104405117361111,"rotationalPeriodTidallyLocked":true,"axialTilt":-0.023607,"materials":{"Sulphur":29.99,"Carbon":25.21,"Phosphorus":16.14,"Iron":9.43,"Nickel":7.14,"Selenium":4.69,"Chromium":4.24,"Arsenic":1.41,"Niobium":0.64,"Ruthenium":0.58,"Tungsten":0.52},"updateTime":"2020-09-27 16:24:56"},{"id":9510005,"id64":1585268801685983970,"bodyId":44,"name":"Col 285 Sector HD-I c10-6 4","type":"Planet","subType":"Class I gas giant","parents":[{"Null":43},{"Star":0}],"distanceToArrival":2870,"isLandable":false,"gravity":1.931541203663392,"earthMasses":205.879501,"radius":65847.468,"surfaceTemperature":102,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":{"Hydrogen":74.13,"Helium":25.87},"solidComposition":null,"terraformingState":null,"orbitalPeriod":577.6202858046297,"semiMajorAxis":0.0034854412528874316,"orbitalEccentricity":0.002753,"orbitalInclination":2.651511,"argOfPeriapsis":92.859461,"rotationalPeriod":8.558259847337963,"rotationalPeriodTidallyLocked":false,"axialTilt":0.292793,"updateTime":"2020-09-27 16:25:15"},{"id":9509968,"id64":1621297598704947938,"bodyId":45,"name":"Col 285 Sector HD-I c10-6 4 a","type":"Planet","subType":"Icy body","parents":[{"Planet":44},{"Null":43},{"Star":0}],"distanceToArrival":2867,"isLandable":true,"gravity":0.06178621120032692,"earthMasses":0.001634,"radius":1037.205375,"surfaceTemperature":76,"surfacePressure":null,"volcanismType":"Carbon Dioxide Geysers","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Ice":82,"Rock":16.36,"Metal":1.64},"terraformingState":null,"orbitalPeriod":2.6778391114004627,"semiMajorAxis":0.003215151538023596,"orbitalEccentricity":0.002201,"orbitalInclination":-0.150188,"argOfPeriapsis":121.834678,"rotationalPeriod":2.6778760858564814,"rotationalPeriodTidallyLocked":true,"axialTilt":-0.315035,"materials":{"Sulphur":28.49,"Carbon":23.95,"Phosphorus":15.34,"Iron":13.03,"Nickel":9.86,"Zinc":3.54,"Arsenic":1.68,"Zirconium":1.51,"Cadmium":1.01,"Ruthenium":0.8,"Tin":0.78},"updateTime":"2020-09-27 16:25:19"},{"id":9510055,"id64":1657326395723911906,"bodyId":46,"name":"Col 285 Sector HD-I c10-6 4 b","type":"Planet","subType":"Icy body","parents":[{"Planet":44},{"Null":43},{"Star":0}],"distanceToArrival":2865,"isLandable":true,"gravity":0.04876768197453438,"earthMasses":0.000804,"radius":818.9294375,"surfaceTemperature":75,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Ice":81.47,"Rock":16.84,"Metal":1.69},"terraformingState":null,"orbitalPeriod":7.221491317511574,"semiMajorAxis":0.006229162387067987,"orbitalEccentricity":0.001555,"orbitalInclination":0.509836,"argOfPeriapsis":315.160361,"rotationalPeriod":-7.221590597673611,"rotationalPeriodTidallyLocked":false,"axialTilt":2.359732,"materials":{"Sulphur":26.53,"Carbon":22.31,"Phosphorus":14.28,"Iron":12.24,"Nickel":9.26,"Chromium":5.51,"Selenium":4.15,"Vanadium":3.01,"Cadmium":0.95,"Tellurium":0.91,"Niobium":0.84},"updateTime":"2020-09-27 16:25:22"},{"id":9510156,"id64":1693355192742875874,"bodyId":47,"name":"Col 285 Sector HD-I c10-6 4 c","type":"Planet","subType":"Icy body","parents":[{"Planet":44},{"Null":43},{"Star":0}],"distanceToArrival":2868,"isLandable":true,"gravity":0.050917268910152295,"earthMasses":0.000924,"radius":859.1875,"surfaceTemperature":74,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Ice":82.15,"Rock":16.23,"Metal":1.62},"terraformingState":null,"orbitalPeriod":10.524553971157408,"semiMajorAxis":0.008007203929867165,"orbitalEccentricity":0.000734,"orbitalInclination":-0.026192,"argOfPeriapsis":4.168939,"rotationalPeriod":10.524700388993056,"rotationalPeriodTidallyLocked":true,"axialTilt":1.255045,"materials":{"Sulphur":26.9,"Carbon":22.62,"Phosphorus":14.48,"Iron":12.27,"Nickel":9.28,"Chromium":5.52,"Manganese":5.07,"Zirconium":1.42,"Tellurium":0.92,"Molybdenum":0.8,"Tin":0.73},"updateTime":"2020-09-27 16:25:24"},{"id":9509921,"id64":1729383989761839842,"bodyId":48,"name":"Col 285 Sector HD-I c10-6 4 d","type":"Planet","subType":"Icy body","parents":[{"Planet":44},{"Null":43},{"Star":0}],"distanceToArrival":2864,"isLandable":true,"gravity":0.0529750943390093,"earthMasses":0.001035,"radius":891.4948125,"surfaceTemperature":74,"surfacePressure":null,"volcanismType":"No volcanism","atmosphereType":"No atmosphere","atmosphereComposition":null,"solidComposition":{"Ice":81.97,"Rock":16.39,"Metal":1.65},"terraformingState":null,"orbitalPeriod":16.998492733194446,"semiMajorAxis":0.011022632680438947,"orbitalEccentricity":0.002131,"orbitalInclination":-0.442191,"argOfPeriapsis":134.02118,"rotationalPeriod":-16.998725718043982,"rotationalPeriodTidallyLocked":false,"axialTilt":-2.892525,"materials":{"Sulphur":26.33,"Carbon":22.14,"Phosphorus":14.18,"Iron":12.06,"Nickel":9.12,"Chromium":5.42,"Manganese":4.98,"Zinc":3.28,"Cadmium":0.94,"Tellurium":0.9,"Tungsten":0.66},"updateTime":"2020-09-27 16:25:26"},{"id":9509862,"id64":1765412786780803810,"bodyId":49,"name":"Col 285 Sector HD-I c10-6 5","type":"Planet","subType":"Icy body","parents":[{"Null":43},{"Star":0}],"distanceToArrival":2913,"isLandable":false,"gravity":1.4885837612346957,"earthMasses":6.332083,"radius":13154.404,"surfaceTemperature":434,"surfacePressure":26265.804648408586,"volcanismType":"Major Water Geysers","atmosphereType":"Thick Methane-rich","atmosphereComposition":{"Ammonia":33.22,"Methane":33.22,"Nitrogen":33.22},"solidComposition":{"Ice":68.15,"Rock":21.28,"Metal":10.58},"terraformingState":null,"orbitalPeriod":577.6202858046297,"semiMajorAxis":0.11332776476754358,"orbitalEccentricity":0.002753,"orbitalInclination":2.651511,"argOfPeriapsis":272.859456,"rotationalPeriod":2.2369896591319445,"rotationalPeriodTidallyLocked":false,"axialTilt":-0.021078,"rings":[{"name":"Col 285 Sector HD-I c10-6 5 A Ring","type":"Icy","mass":1765.7,"innerRadius":24434,"outerRadius":64406}],"reserveLevel":"Pristine","updateTime":"2020-09-27 16:25:29"},{"id":9509298,"id64":1837470380818731746,"bodyId":51,"name":"Col 285 Sector HD-I c10-6 6","type":"Planet","subType":"Icy body","parents":[{"Star":0}],"distanceToArrival":3967,"isLandable":false,"gravity":1.9437949623991682,"earthMasses":13.961077,"radius":17093.018,"surfaceTemperature":64,"surfacePressure":1.9004108068097705,"volcanismType":"Water Geysers","atmosphereType":"Helium","atmosphereComposition":{"Helium":87.81,"Hydrogen":8.28,"Neon":2.2},"solidComposition":{"Ice":65.55,"Rock":20.47,"Metal":10.18},"terraformingState":null,"orbitalPeriod":9299.154841789468,"semiMajorAxis":7.900473042898064,"orbitalEccentricity":0.010405,"orbitalInclination":7.690529,"argOfPeriapsis":21.683897,"rotationalPeriod":0.8699007840046296,"rotationalPeriodTidallyLocked":false,"axialTilt":0.088096,"rings":[{"name":"Col 285 Sector HD-I c10-6 6 A Ring","type":"Icy","mass":46783000000,"innerRadius":29513,"outerRadius":83827}],"reserveLevel":"Pristine","updateTime":"2020-09-27 16:26:51"},{"id":9509237,"id64":1909527974856659682,"bodyId":53,"name":"Col 285 Sector HD-I c10-6 6 a","type":"Planet","subType":"Icy body","parents":[{"Planet":51},{"Star":0}],"distanceToArrival":3968,"isLandable":false,"gravity":0.03046734938657355,"earthMasses":0.000201,"radius":518.04228125,"surfaceTemperature":85,"surfacePressure":0.04413330981495189,"volcanismType":"No volcanism","atmosphereType":"Thin Methane","atmosphereComposition":{"Methane":100},"solidComposition":{"Ice":82.33,"Rock":16.07,"Metal":1.6},"terraformingState":null,"orbitalPeriod":10.658589778125,"semiMajorAxis":0.0032930044799524675,"orbitalEccentricity":0.000253,"orbitalInclination":0.117732,"argOfPeriapsis":321.660157,"rotationalPeriod":10.659185218726853,"rotationalPeriodTidallyLocked":true,"axialTilt":0.061118,"updateTime":"2020-09-27 16:26:55"},{"id":9509201,"id64":1945556771875623650,"bodyId":54,"name":"Col 285 Sector HD-I c10-6 6 b","type":"Planet","subType":"Icy body","parents":[{"Planet":51},{"Star":0}],"distanceToArrival":3969,"isLandable":false,"gravity":0.037929448956971056,"earthMasses":0.000387,"radius":644.246,"surfaceTemperature":88,"surfacePressure":0.06860185549469529,"volcanismType":"No volcanism","atmosphereType":"Thin Methane","atmosphereComposition":{"Methane":100},"solidComposition":{"Ice":82.33,"Rock":16.07,"Metal":1.6},"terraformingState":null,"orbitalPeriod":18.206305663900462,"semiMajorAxis":0.004705513423486983,"orbitalEccentricity":0.002349,"orbitalInclination":-0.00171,"argOfPeriapsis":194.997492,"rotationalPeriod":18.207320390127315,"rotationalPeriodTidallyLocked":true,"axialTilt":-0.457172,"updateTime":"2020-09-27 16:26:59"},{"id":10151670,"id64":1981585568894587618,"bodyId":55,"name":"Col 285 Sector HD-I c10-6 6 c","type":"Planet","subType":"Icy body","parents":[{"Planet":51},{"Star":0}],"distanceToArrival":3971,"isLandable":false,"gravity":0.038157196686946185,"earthMasses":0.000388,"radius":643.1498125,"surfaceTemperature":88,"surfacePressure":0.06852527737478412,"volcanismType":"No volcanism","atmosphereType":"Thin Methane","atmosphereComposition":{"Methane":100},"solidComposition":{"Ice":81.44,"Rock":16.85,"Metal":1.71},"terraformingState":null,"orbitalPeriod":99.62514732723379,"semiMajorAxis":0.014611847176600223,"orbitalEccentricity":0.00037,"orbitalInclination":1.340112,"argOfPeriapsis":301.826531,"rotationalPeriod":9.546975648159723,"rotationalPeriodTidallyLocked":false,"axialTilt":1.82993,"updateTime":"2020-09-27 16:27:03"},{"id":10151674,"id64":2017614365913551586,"bodyId":56,"name":"Col 285 Sector HD-I c10-6 6 d","type":"Planet","subType":"Icy body","parents":[{"Planet":51},{"Star":0}],"distanceToArrival":3960,"isLandable":false,"gravity":0.030081830736610627,"earthMasses":0.000193,"radius":510.87075,"surfaceTemperature":85,"surfacePressure":0.042907819057488285,"volcanismType":"No volcanism","atmosphereType":"Thin Methane","atmosphereComposition":{"Methane":100},"solidComposition":{"Ice":82.33,"Rock":16.07,"Metal":1.6},"terraformingState":null,"orbitalPeriod":161.93709991596066,"semiMajorAxis":0.020200247842726816,"orbitalEccentricity":0.000191,"orbitalInclination":1.723332,"argOfPeriapsis":111.262771,"rotationalPeriod":1.3819401119097223,"rotationalPeriodTidallyLocked":false,"axialTilt":-0.090105,"updateTime":"2020-09-27 16:27:07"}],"date":"2016-06-25 20:39:14"}'''
STAR_JSON = '''{"id":262293465,"id64":111197315617635,"bodyId":0,"name":"Scheau Pri AI-H d11-3236","type":"Star","subType":"A (Blue-White) Star","parents":null,"distanceToArrival":0,"isMainStar":true,"isScoopable":true,"age":346,"spectralClass":"A5","luminosity":"VI","absoluteMagnitude":2.44072,"solarMasses":1.679688,"solarRadius":1.3630980416966212,"surfaceTemperature":8578,"orbitalPeriod":null,"semiMajorAxis":null,"orbitalEccentricity":null,"orbitalInclination":null,"argOfPeriapsis":null,"rotationalPeriod":0.8252606361921296,"rotationalPeriodTidallyLocked":false,"axialTilt":0,"belts":[{"name":"Scheau Pri AI-H d11-3236 A Belt","type":"Rocky","mass":2867700000000000,"innerRadius":199710000,"outerRadius":317030000}],"updateTime":"2020-12-08 12:32:47","systemId":59547780,"systemId64":111197315617635,"systemName":"Scheau Pri AI-H d11-3236"}'''
STATION_JSON = '''{"id":63421,"marketId":null,"type":"Mega ship","name":"Rescue Ship - Malthus Terminal","distanceToArrival":599.329712,"allegiance":"Pilots Federation","government":"Democracy","economy":"Rescue","secondEconomy":null,"haveMarket":true,"haveShipyard":false,"haveOutfitting":true,"otherServices":["Restock","Refuel","Repair","Contacts","Missions","Tuning","Search and Rescue"],"controllingFaction":{"id":80576,"name":"Pilots Federation Local Branch"},"updateTime":{"information":"2018-01-25 06:10:31","market":"2018-01-25 06:10:31","shipyard":null,"outfitting":"2018-01-25 06:10:31"},"systemId":25480,"systemId64":1419209836875,"systemName":"Pleiades Sector HR-W d1-41","commodities":[{"id":"basicmedicines","name":"Basic Medicines","buyPrice":0,"stock":0,"sellPrice":3214,"demand":1699983,"stockBracket":0},{"id":"clothing","name":"Clothing","buyPrice":0,"stock":0,"sellPrice":58,"demand":8379,"stockBracket":0},{"id":"cmmcomposite","name":"CMM Composite","buyPrice":0,"stock":0,"sellPrice":7904,"demand":34289,"stockBracket":0},{"id":"coolinghoses","name":"Micro-weave Cooling Hoses","buyPrice":0,"stock":0,"sellPrice":3047,"demand":39144,"stockBracket":0},{"id":"evacuationshelter","name":"Evacuation Shelter","buyPrice":0,"stock":0,"sellPrice":2506,"demand":408050,"stockBracket":0},{"id":"hazardousenvironmentsuits","name":"H.E. Suits","buyPrice":0,"stock":0,"sellPrice":1297,"demand":6701100,"stockBracket":0},{"id":"insulatingmembrane","name":"Insulating Membrane","buyPrice":0,"stock":0,"sellPrice":12586,"demand":18009,"stockBracket":0},{"id":"liquidoxygen","name":"Liquid Oxygen","buyPrice":0,"stock":0,"sellPrice":796,"demand":144400,"stockBracket":0},{"id":"naturalfabrics","name":"Natural Fabrics","buyPrice":0,"stock":0,"sellPrice":70,"demand":41492,"stockBracket":0},{"id":"neofabricinsulation","name":"Neofabric Insulation","buyPrice":0,"stock":0,"sellPrice":7189,"demand":12665,"stockBracket":0},{"id":"water","name":"Water","buyPrice":0,"stock":0,"sellPrice":835,"demand":3568990,"stockBracket":0}],"ships":null,"outfitting":[{"id":"int_cargorack_size1_class1","name":"1E Cargo Rack"},{"id":"int_dronecontrol_collection_size1_class1","name":"1E Collector Limpet Controller"},{"id":"int_dronecontrol_collection_size3_class1","name":"3E Collector Limpet Controller"},{"id":"int_dronecontrol_resourcesiphon_size1_class1","name":"1E Hatch Breaker Limpet Controller"},{"id":"int_fsdinterdictor_size1_class1","name":"1E Frame Shift Drive Interdictor"},{"id":"int_fuelscoop_size1_class1","name":"1E Fuel Scoop"},{"id":"int_refinery_size1_class1","name":"1E Refinery"},{"id":"int_repairer_size1_class1","name":"1E Auto Field-Maintenance Unit"},{"id":"int_repairer_size2_class1","name":"2E Auto Field-Maintenance Unit"},{"id":"int_shieldgenerator_size2_class1","name":"2E Shield Generator"},{"id":"int_stellarbodydiscoveryscanner_standard","name":"1E Basic Discovery Scanner"}]}'''


def main(argv):
    del argv
    logging.info('Starting pipeline...')
    population_dict = json.loads(POPULATION_JSON)

    if FLAGS.channel_type == 'insecure':
        channel = grpc.insecure_channel('%s:%s' %
                                        (FLAGS.server_host, FLAGS.server_port))
    else:
        channel = grpc.secure_channel(
            '%s:%s' % (FLAGS.server_host, FLAGS.server_port),
            grpc.ssl_channel_credentials())

    stub = api_raxxla_pb2_grpc.RaxxlaStub(channel)

    # Planet
    # planets = [
    #     x for x in population_dict.get('bodies') if x.get('type') == 'Planet'
    # ]
    # for planet in planets:
    #     planet_json = json.dumps(planet)

    #     planet_proto = stub.ConvertPlanetJson(
    #         api_raxxla_pb2.EdsmRequest(json=planet_json))
    #     stub.SetPlanet(
    #         api_raxxla_pb2.PlanetRequest(
    #             id=planet_proto.id,
    #             planet=planet_proto,
    #         ))
    #     planet_datastore_entity = stub.GetPlanet(
    #         api_raxxla_pb2.GetRequest(id=planet_proto.id))
    # logging.info('Planet passed with %s planet(s)!', len(planets))

    # Population
    # population_proto = stub.ConvertPopulationJson(
    #     api_raxxla_pb2.EdsmRequest(json=POPULATION_JSON))
    # stub.SetPopulation(
    #     api_raxxla_pb2.PopulationRequest(
    #         id=population_proto.system_id,
    #         population=population_proto,
    #     ))
    # population_datastore_entity = stub.GetPopulation(
    #     api_raxxla_pb2.GetRequest(id=population_proto.system_id))
    # logging.info('Population passed!')

    # Powerplay
    # powerplay_proto = stub.ConvertPowerplayJson(
    #     api_raxxla_pb2.EdsmRequest(json=POWERPLAY_JSON))
    # stub.SetPowerplay(
    #     api_raxxla_pb2.PowerplayRequest(
    #         id=powerplay_proto.system_id,
    #         powerplay=powerplay_proto,
    #     ))
    # powerplay_datastore_entity = stub.GetPowerplay(
    #     api_raxxla_pb2.GetRequest(id=powerplay_proto.system_id))
    # logging.info('Powerplay passed!')

    # Settlement
    # stations = population_dict.get('stations')
    # for station in stations:
    #     station_json = json.dumps(station)
    #     settlement_proto = stub.ConvertStationJson(
    #         api_raxxla_pb2.EdsmRequest(json=station_json))
    #     stub.SetSettlement(
    #         api_raxxla_pb2.SettlementRequest(
    #             id=settlement_proto.id,
    #             settlement=settlement_proto,
    #         ))
    #     settlement_datastore_entity = stub.GetSettlement(
    #         api_raxxla_pb2.GetRequest(id=settlement_proto.id))
    # logging.info('Settlement passed with %s settlement(s)!', len(stations))

    # Star
    # stars = [
    #     x for x in population_dict.get('bodies') if x.get('type') == 'Star'
    # ]
    # for star in stars:
    #     star_json = json.dumps(star)

    #     star_proto = stub.ConvertStarJson(
    #         api_raxxla_pb2.EdsmRequest(json=star_json))
    #     stub.SetStar(
    #         api_raxxla_pb2.StarRequest(
    #             id=star_proto.id,
    #             star=star_proto,
    #         ))
    #     star_datastore_entity = stub.GetStar(
    #         api_raxxla_pb2.GetRequest(id=star_proto.id))
    # logging.info('Star passed with %s star(s)!', len(stars))

    # System
    # system_proto = stub.ConvertSystemJson(
    #     api_raxxla_pb2.EdsmRequest(json=POPULATION_JSON))
    # stub.SetSystem(
    #     api_raxxla_pb2.SystemRequest(
    #         id=system_proto.id,
    #         system=system_proto,
    #     ))
    # system_datastore_entity = stub.GetSystem(
    #     api_raxxla_pb2.GetRequest(id=system_proto.id))

    # Planets in system
    planet_entities = stub.GetPlanetsInSystem(
        api_raxxla_pb2.GetRequest(id=1732851569378))
    logging.info('Planets in system passed!')

    channel.close()


if __name__ == '__main__':
    app.run(main)
